# ~/.bashrc: Phoenix Laptop Edition
# Production-grade configuration for Ryzen HX370 + RTX 5080
# Last updated: November 2025

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# CORE BASH CONFIGURATION
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# If not running interactively, don't do anything
case $- in
    *i*) ;;
      *) return;;
esac

# History configuration (larger for power users)
HISTCONTROL=ignoreboth:erasedups
HISTSIZE=10000
HISTFILESIZE=20000
HISTTIMEFORMAT="%F %T "
shopt -s histappend

# Window size update
shopt -s checkwinsize

# Globstar for recursive wildcards
shopt -s globstar

# Better less experience
[ -x /usr/bin/lesspipe ] && eval "$(SHELL=/bin/sh lesspipe)"

# Chroot identification
if [ -z "${debian_chroot:-}" ] && [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# PHOENIX ENVIRONMENT VARIABLES
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

export PHOENIX_ROOT="/mnt/c/dev/phoenix"
export PHOENIX_VENV="$PHOENIX_ROOT/phoenix.venv"
export PHOENIX_CONFIGS="$PHOENIX_ROOT/configs"
export PHOENIX_DATA="$PHOENIX_ROOT/data"
export PHOENIX_LOGS="$PHOENIX_ROOT/logs"

# Docker configuration
export DOCKER_HOST="unix:///var/run/docker.sock"
export COMPOSE_DOCKER_CLI_BUILD=1
export DOCKER_BUILDKIT=1

# Python configuration
export PYTHONUNBUFFERED=1
export PIP_REQUIRE_VIRTUALENV=true

# Editor preferences
export EDITOR="nvim"
export VISUAL="nvim"

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# OH-MY-POSH THEME (Greyhat Aesthetic)
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

if command -v oh-my-posh &> /dev/null; then
    if [ -f "$PHOENIX_ROOT/dotfiles/my-theme.omp.json" ]; then
        eval "$(oh-my-posh init bash --config $PHOENIX_ROOT/dotfiles/my-theme.omp.json)"
    else
        echo "WARNING:  Oh-My-Posh theme not found at $PHOENIX_ROOT/dotfiles/my-theme.omp.json"
    fi
else
    echo "WARNING:  Oh-My-Posh not installed. Run: sudo wget https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/posh-linux-amd64 -O /usr/local/bin/oh-my-posh && sudo chmod +x /usr/local/bin/oh-my-posh"
fi

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# COLOR SUPPORT
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

if [ -x /usr/bin/dircolors ]; then
    test -r ~/.dircolors && eval "$(dircolors -b ~/.dircolors)" || eval "$(dircolors -b)"
    alias ls='ls --color=auto'
    alias grep='grep --color=auto'
    alias fgrep='fgrep --color=auto'
    alias egrep='egrep --color=auto'
    alias diff='diff --color=auto'
fi

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# PHOENIX ALIASES (Greyhat Productivity)
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# Navigation
alias phoenix='cd $PHOENIX_ROOT'
alias pconf='cd $PHOENIX_CONFIGS'
alias pdata='cd $PHOENIX_DATA'
alias plogsdir='cd $PHOENIX_LOGS'

# Python venv
alias penv='source $PHOENIX_VENV/bin/activate'
alias pdeact='deactivate'

# Docker shortcuts
alias d='docker'
alias dc='docker compose'
alias dps='docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"'
alias dpsa='docker ps -a --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"'
alias dlog='docker logs -f'
alias dexec='docker exec -it'
alias dclean='docker system prune -af && docker volume prune -f'

# Git shortcuts
alias g='git'
alias gs='git status'
alias ga='git add'
alias gc='git commit -m'
alias gp='git push'
alias gl='git pull'
alias glog='git log --oneline --graph --decorate --all'

# System monitoring (greyhat style)
alias htop='btop'
alias ports='sudo netstat -tulpn | grep LISTEN'
alias gpu='nvidia-smi'
alias temp='watch -n 2 sensors'

# Enhanced ls
alias ll='ls -alFh'
alias la='ls -A'
alias l='ls -CF'
alias lt='ls -alFht'  # Sort by time
alias lsize='ls -alFhS'  # Sort by size

# Safety nets
alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# GREYHAT DOCKER ENVIRONMENTS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# Kali Linux disposable environment
alias kali="docker run -it --rm --network host kalilinux/kali-rolling /bin/bash"

# Python sandbox
alias pybox="docker run -it --rm -v $(pwd):/workspace -w /workspace python:3.11 bash"

# Ubuntu sandbox
alias ubox="docker run -it --rm -v $(pwd):/workspace -w /workspace ubuntu:24.04 bash"

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# PHOENIX AUTO-ACTIVATION
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# Function to check Docker service
check_docker() {
    if ! docker info &> /dev/null; then
        echo "WARNING:  Docker service not running. Starting..."
        sudo service docker start
    fi
}

# Function to activate Phoenix venv
activate_phoenix_venv() {
    if [ -d "$PHOENIX_VENV" ]; then
        if [ -f "$PHOENIX_VENV/bin/activate" ]; then
            source "$PHOENIX_VENV/bin/activate"
            echo "OK: Phoenix venv activated"
        else
            echo "WARNING:  Phoenix venv exists but activation script missing"
        fi
    else
        echo "WARNING:  Phoenix venv not found at $PHOENIX_VENV"
        echo "   Run: python3 -m venv $PHOENIX_VENV"
    fi
}

# Function to check Docker stack status
check_battlestack() {
    if docker ps --format '{{.Names}}' | grep -q "phoenix_"; then
        echo "OK: Phoenix Battlestack ONLINE"
        docker ps --format "table {{.Names}}\t{{.Status}}" | grep "phoenix_"
    else
        echo "WARNING:  Phoenix Battlestack OFFLINE"
        echo "   Start with: phoenix && dc -f configs/docker/docker-compose.tier1.yml up -d"
    fi
}

# Auto-run on interactive shell start (non-invasive)
if [[ $- == *i* ]]; then
    # Navigate to Phoenix root
    cd "$PHOENIX_ROOT" 2>/dev/null || cd ~
    
    # Check Docker
    check_docker
    
    # Auto-activate venv (silent if already activated)
    if [ -z "$VIRTUAL_ENV" ]; then
        activate_phoenix_venv
    fi
    
    # Show Battlestack status (non-blocking)
    check_battlestack
    
    echo ""
    echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
    echo "  PHOENIX PHOENIX LAPTOP READY - Ryzen HX370 + RTX 5080"
    echo ""
    if [ -f "/mnt/c/dev/phoenix/configs/motd/phoenix-commands.txt" ]; then
        cat "/mnt/c/dev/phoenix/configs/motd/phoenix-commands.txt"
    fi
    echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
fi

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# NODE VERSION MANAGER (NVM) - Optional
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

export NVM_DIR="$HOME/.nvm"
if [ -s "$NVM_DIR/nvm.sh" ]; then
    \. "$NVM_DIR/nvm.sh"
fi
if [ -s "$NVM_DIR/bash_completion" ]; then
    \. "$NVM_DIR/bash_completion"
fi

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# BASH COMPLETION
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

if ! shopt -oq posix; then
  if [ -f /usr/share/bash-completion/bash_completion ]; then
    . /usr/share/bash-completion/bash_completion
  elif [ -f /etc/bash_completion ]; then
    . /etc/bash_completion
  fi
fi

# Docker completion
if [ -f /usr/share/bash-completion/completions/docker ]; then
    . /usr/share/bash-completion/completions/docker
fi

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# CUSTOM FUNCTIONS (Power Tools)
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# Quick Docker container shell
dsh() {
    if [ -z "$1" ]; then
        echo "Usage: dsh <container_name>"
        return 1
    fi
    docker exec -it "$1" /bin/bash || docker exec -it "$1" /bin/sh
}

# Quick git commit and push
gcp() {
    if [ -z "$1" ]; then
        echo "Usage: gcp '<commit message>'"
        return 1
    fi
    git add .
    git commit -m "$1"
    git push
}

# Find process by port
port() {
    if [ -z "$1" ]; then
        echo "Usage: port <port_number>"
        return 1
    fi
    sudo lsof -i ":$1"
}

# Quick Python module install in venv
pinstall() {
    if [ -z "$VIRTUAL_ENV" ]; then
        echo "WARNING:  No venv active. Activating Phoenix venv..."
        source "$PHOENIX_VENV/bin/activate"
    fi
    pip install "$@"
}


# Restart Docker service
drestart() {
    sudo service docker restart
    echo "OK: Docker service restarted"
}

# Clean Docker completely
dnuke() {
    echo "WARNING:  This will remove ALL Docker containers, images, and volumes!"
    read -p "Are you sure? (yes/no): " confirm
    if [ "$confirm" = "yes" ]; then
        docker stop $(docker ps -aq) 2>/dev/null
        docker rm $(docker ps -aq) 2>/dev/null
        docker rmi $(docker images -q) 2>/dev/null
        docker volume rm $(docker volume ls -q) 2>/dev/null
        docker network prune -f
        echo "OK: Docker nuked"
    else
        echo "Cancelled"
    fi
}

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# END OF PHOENIX BASHRC
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# ============================================================================
# PHOENIX BATTLESTACK AUTOMATION - Shell Functions
# ============================================================================

# Source Phoenix management functions (menu, status, health checks, etc.)
if [ -f "/mnt/c/dev/phoenix/scripts/phoenix-functions.sh" ]; then
    source "/mnt/c/dev/phoenix/scripts/phoenix-functions.sh"
fi

# Display enhanced Phoenix banner on first login (one-time per session)
if [ -z "$PHOENIX_BANNER_SHOWN" ]; then
    export PHOENIX_BANNER_SHOWN=1
    
    # Show Phoenix banner
    if [ -f "/mnt/c/dev/phoenix/configs/motd/phoenix-banner.txt" ]; then
        echo ""
        cat "/mnt/c/dev/phoenix/configs/motd/phoenix-banner.txt"
        echo ""
    fi
    
    # Show system status
    if [ -f "/mnt/c/dev/phoenix/scripts/monitoring/phoenix-status.sh" ]; then
        bash "/mnt/c/dev/phoenix/scripts/monitoring/phoenix-status.sh"
        echo ""
    fi
    
    # Show available commands
        echo ""
fi

# ============================================================================
# GOOGLE CLI INSTALL
# ============================================================================

# Google Cloud SDK

export PATH="$HOME/google-cloud-sdk/bin:$PATH"

# ============================================================================
# GIT SSH AUTO-AUTHENTICATION
# ============================================================================

# Start SSH agent and load GitHub key automatically

if [ -z "$SSH_AUTH_SOCK" ]; then
    eval "$(ssh-agent -s)" > /dev/null 2>&1
    ssh-add ~/.ssh/github_phoenix > /dev/null 2>&1
fi

# ============================================================================
# CREWAI CONFIGS
# ============================================================================

# CrewAI Ollama Configuration

export OPENAI_API_KEY="sk-fake-key-for-local-ollama"
export OPENAI_BASE_URL="http://localhost:11434/v1"

# ============================================================================
# END PHOENIX BATTLESTACK AUTOMATION
# ============================================================================


# ============================================================================
# PHOENIX BATTLESTACK โ PROFESSIONAL .BASHRC ADDITIONS
# Add to: /mnt/c/dev/phoenix/dotfiles/.bashrc-phoenix
# ============================================================================

# ============================================================================
# SECTION 1: PHOENIX CORE STATUS
# ============================================================================

# Master status check (all services)
ph-status() {
    echo "=== PHOENIX BATTLESTACK STATUS ==="
    docker ps --filter name=phoenix_ --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}" | \
        grep -E "(phoenix_|NAMES)" | \
        sed 's/phoenix_//g' | \
        column -t
    echo ""
    echo "GPU: $(nvidia-smi --query-gpu=name,memory.used,memory.total --format=csv,noheader 2>/dev/null || echo 'Not available')"
}

# Quick health check (only unhealthy/down services)
ph-health() {
    echo "=== PHOENIX HEALTH ALERTS ==="
    docker ps --filter name=phoenix_ --format "{{.Names}}: {{.Status}}" | \
        grep -v "healthy\|Up" | \
        sed 's/phoenix_//g' || echo "โ All services healthy"
}

# GPU monitoring
ph-gpu() {
    if ! command -v nvidia-smi &> /dev/null; then
        echo "โ NVIDIA drivers not available"
        return 1
    fi
    
    echo "=== PHOENIX GPU STATUS ==="
    nvidia-smi --query-gpu=timestamp,name,utilization.gpu,utilization.memory,memory.used,memory.total,temperature.gpu,power.draw --format=csv
    echo ""
    echo "=== OLLAMA CONTAINER ==="
    docker exec phoenix_ollama nvidia-smi 2>/dev/null || echo "โ GPU not visible in Ollama container"
}

# Live GPU monitoring (updates every 3s)
ph-gpu-watch() {
    watch -n 3 "nvidia-smi --query-gpu=timestamp,name,utilization.gpu,utilization.memory,memory.used,memory.total,temperature.gpu,power.draw --format=csv,noheader && echo '' && docker stats --no-stream phoenix_ollama 2>/dev/null"
}

# ============================================================================
# SECTION 2: DATABASE OPERATIONS
# ============================================================================

# Connect to PostgreSQL
ph-db() {
    docker exec -it phoenix_postgres psql -U phoenix -d phoenix_core
}

# Quick database query
ph-query() {
    local query="$1"
    if [[ -z "$query" ]]; then
        echo "Usage: ph-query 'SELECT * FROM core.companies LIMIT 5;'"
        return 1
    fi
    docker exec -i phoenix_postgres psql -U phoenix -d phoenix_core -c "$query"
}

# List all schemas
ph-schemas() {
    ph-query "SELECT schema_name FROM information_schema.schemata WHERE schema_name NOT IN ('pg_catalog', 'information_schema', 'pg_toast') ORDER BY schema_name;"
}

# Count tables per schema
ph-tables() {
    ph-query "SELECT schemaname, COUNT(*) AS table_count FROM pg_tables WHERE schemaname IN ('core','events','intelligence','agents','neuroscience','enrichment','products') GROUP BY schemaname ORDER BY schemaname;"
}

# Database backup
ph-backup() {
    local timestamp=$(date +%Y%m%d_%H%M%S)
    local backup_dir="/mnt/c/dev/phoenix/backups"
    mkdir -p "$backup_dir"
    
    echo "๐ Backing up phoenix_core..."
    docker exec phoenix_postgres pg_dump -U phoenix phoenix_core | gzip > "$backup_dir/phoenix_core_${timestamp}.sql.gz"
    
    if [[ $? -eq 0 ]]; then
        echo "โ Backup saved: $backup_dir/phoenix_core_${timestamp}.sql.gz"
        ls -lh "$backup_dir" | tail -1
    else
        echo "โ Backup failed"
        return 1
    fi
}

# Database restore
ph-restore() {
    local backup_file="$1"
    if [[ -z "$backup_file" || ! -f "$backup_file" ]]; then
        echo "Usage: ph-restore /path/to/backup.sql.gz"
        echo "Available backups:"
        ls -lh /mnt/c/dev/phoenix/backups/*.sql.gz 2>/dev/null || echo "No backups found"
        return 1
    fi
    
    echo "โ๏ธ  This will overwrite phoenix_core database. Continue? (yes/no)"
    read -r confirm
    if [[ "$confirm" != "yes" ]]; then
        echo "Cancelled"
        return 0
    fi
    
    echo "๐ Restoring database..."
    gunzip -c "$backup_file" | docker exec -i phoenix_postgres psql -U phoenix -d phoenix_core
    
    if [[ $? -eq 0 ]]; then
        echo "โ Database restored"
    else
        echo "โ Restore failed"
        return 1
    fi
}

# ============================================================================
# SECTION 3: SERVICE MANAGEMENT
# ============================================================================

# Restart specific service
ph-restart() {
    local service="$1"
    if [[ -z "$service" ]]; then
        echo "Usage: ph-restart <service>"
        echo "Available services:"
        docker ps --filter name=phoenix_ --format "{{.Names}}" | sed 's/phoenix_/  - /g'
        return 1
    fi
    
    echo "๐ Restarting phoenix_${service}..."
    docker restart "phoenix_${service}"
    sleep 2
    docker ps --filter name="phoenix_${service}" --format "{{.Names}}: {{.Status}}"
}

# Stop all Phoenix services
ph-stop() {
    echo "โ๏ธ  Stopping all Phoenix services..."
    docker ps --filter name=phoenix_ --format "{{.Names}}" | xargs -r docker stop
    echo "โ All services stopped"
}

# Start all Phoenix services
ph-start() {
    echo "๐ Starting Phoenix Battlestack..."
    cd /mnt/c/dev/phoenix/docker && docker-compose up -d
    sleep 5
    ph-status
}

# Full system restart
ph-reboot() {
    echo "๐ Rebooting Phoenix Battlestack..."
    ph-stop
    sleep 2
    ph-start
}

# ============================================================================
# SECTION 4: LOGS & DEBUGGING
# ============================================================================

# Tail logs for service
ph-logs() {
    local service="$1"
    local lines="${2:-100}"
    
    if [[ -z "$service" ]]; then
        echo "Usage: ph-logs <service> [lines]"
        echo "Available services:"
        docker ps --filter name=phoenix_ --format "{{.Names}}" | sed 's/phoenix_/  - /g'
        return 1
    fi
    
    docker logs -f --tail "$lines" "phoenix_${service}"
}

# Show recent errors across all services
ph-errors() {
    echo "=== PHOENIX ERROR LOG (Last 50 lines) ==="
    for service in $(docker ps --filter name=phoenix_ --format "{{.Names}}"); do
        echo ""
        echo "--- ${service} ---"
        docker logs --tail 50 "$service" 2>&1 | grep -iE "error|fail|fatal|exception" || echo "No errors"
    done
}

# Disk usage check
ph-disk() {
    echo "=== PHOENIX DISK USAGE ==="
    docker system df
    echo ""
    echo "=== VOLUMES ==="
    docker volume ls --filter name=phoenix_ --format "{{.Name}}: {{.Size}}" 2>/dev/null || \
        docker volume ls --filter name=phoenix_
}

# ============================================================================
# SECTION 5: OLLAMA/LLM OPERATIONS
# ============================================================================

# List loaded Ollama models
ph-models() {
    echo "=== OLLAMA MODELS ==="
    docker exec phoenix_ollama ollama list
}

# Run inference test
ph-inference() {
    local model="${1:-llama3.2:3b}"
    local prompt="${2:-Explain Phoenix in 10 words}"
    
    echo "๐ง Testing inference: $model"
    echo "Prompt: $prompt"
    echo ""
    time docker exec phoenix_ollama ollama run "$model" "$prompt" --verbose
}

# Pull new model
ph-pull() {
    local model="$1"
    if [[ -z "$model" ]]; then
        echo "Usage: ph-pull <model>"
        echo "Examples: llama3.2:3b, qwen2.5-coder:7b, gemma2:9b"
        return 1
    fi
    
    echo "๐ฅ Pulling model: $model"
    docker exec phoenix_ollama ollama pull "$model"
}

# Remove model
ph-rm-model() {
    local model="$1"
    if [[ -z "$model" ]]; then
        echo "Usage: ph-rm-model <model>"
        ph-models
        return 1
    fi
    
    echo "๐๏ธ  Removing model: $model"
    docker exec phoenix_ollama ollama rm "$model"
}

# ============================================================================
# SECTION 6: AGENT OPERATIONS
# ============================================================================

# List active agents
ph-agents() {
    ph-query "SELECT agent_name, agent_class, agent_type, status, tasks_completed, dopamine_points FROM agents.agent_registry WHERE is_enabled = TRUE ORDER BY dopamine_points DESC;" 2>/dev/null || \
        echo "โ Agents schema not deployed yet"
}

# Show pending tasks
ph-tasks() {
    ph-query "SELECT task_id, task_type, status, priority_score, created_at FROM agents.tasks WHERE status IN ('pending', 'assigned', 'in_progress') ORDER BY priority_score DESC LIMIT 20;" 2>/dev/null || \
        echo "โ Agents schema not deployed yet"
}

# Show agent leaderboard
ph-leaderboard() {
    ph-query "SELECT agent_name, agent_class, dopamine_points, current_streak, best_streak, tasks_completed, accuracy_score FROM agents.agent_registry WHERE is_enabled = TRUE ORDER BY dopamine_points DESC LIMIT 10;" 2>/dev/null || \
        echo "โ Agents schema not deployed yet"
}

# ============================================================================
# SECTION 7: DEVELOPMENT WORKFLOW
# ============================================================================

# Quick commit (auto-add modified files)
ph-commit() {
    local message="$1"
    if [[ -z "$message" ]]; then
        echo "Usage: ph-commit 'commit message'"
        return 1
    fi
    
    git add -u
    git commit -m "$message"
    git push
}

# Show git status with branch info
ph-git() {
    echo "=== GIT STATUS ==="
    git status -sb
    echo ""
    echo "=== RECENT COMMITS ==="
    git log --oneline -5
}

# Clean docker system (safe)
ph-clean() {
    echo "๐งน Cleaning Docker system..."
    docker system prune -f
    echo "โ Cleanup complete"
}

# Full nuclear clean (WARNING: removes all unused volumes/images)
ph-nuke() {
    echo "โข๏ธ  WARNING: This will remove ALL unused Docker resources"
    echo "Continue? (type 'NUKE' to confirm)"
    read -r confirm
    if [[ "$confirm" != "NUKE" ]]; then
        echo "Cancelled"
        return 0
    fi
    
    docker system prune -af --volumes
    echo "โ Nuclear clean complete"
}

# ============================================================================
# SECTION 8: SHORTCUTS & ALIASES
# ============================================================================

alias phs='ph-status'
alias phh='ph-health'
alias phg='ph-gpu'
alias phd='ph-db'
alias phl='ph-logs'
alias phm='ph-models'
alias pha='ph-agents'
alias pht='ph-tasks'

# ============================================================================
# SECTION 9: CONTEXT AWARENESS
# ============================================================================

# Show current Phoenix environment info
ph-info() {
    echo "=== PHOENIX ENVIRONMENT ==="
    echo "Location: /mnt/c/dev/phoenix"
    echo "Hostname: $(hostname)"
    echo "User: $(whoami)"
    echo "Git branch: $(git branch --show-current 2>/dev/null || echo 'Not a git repo')"
    echo ""
    echo "=== SYSTEM ==="
    echo "CPU: $(lscpu | grep 'Model name' | cut -d: -f2 | xargs)"
    echo "RAM: $(free -h | awk '/^Mem:/ {print $2 " total, " $3 " used"}')"
    echo "GPU: $(nvidia-smi --query-gpu=name --format=csv,noheader 2>/dev/null || echo 'Not available')"
    echo ""
    echo "=== DOCKER ==="
    echo "Services: $(docker ps --filter name=phoenix_ | wc -l) running"
    echo "Disk: $(docker system df --format "{{.Type}}: {{.Size}}" | grep "Local Volumes" || echo 'Unknown')"
}

# Generate daily status report
ph-report() {
    local report_file="/mnt/c/dev/phoenix/logs/daily_report_$(date +%Y%m%d).txt"
    
    {
        echo "PHOENIX DAILY REPORT โ $(date)"
        echo "========================================"
        echo ""
        ph-status
        echo ""
        ph-health
        echo ""
        ph-gpu
        echo ""
        ph-schemas
        echo ""
        ph-agents 2>/dev/null || echo "Agents not deployed"
        echo ""
        ph-disk
    } > "$report_file"
    
    echo "โ Report saved: $report_file"
    echo ""
    tail -20 "$report_file"
}

# ============================================================================
# AUTO-INIT ON SHELL START
# ============================================================================

# Show quick status when opening terminal (comment out if annoying)
# ph-health

echo "๐ฅ Phoenix Battlestack loaded. Type 'ph-info' for environment details."

# ============================================================================
# END OF PHOENIX .BASHRC ADDITIONS
# ============================================================================

